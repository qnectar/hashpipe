// Generated by CoffeeScript 1.8.0
(function() {
  var jquery, jsdom;

  jsdom = require('jsdom');

  jquery = require('jquery');

  exports.html2text = function(inp, args, ctx, cb) {
    return jsdom.env(inp, function(err, window) {
      var $, text;
      $ = jquery(window);
      text = $('h1, h2, h3, p').map(function() {
        return $(this).text();
      }).get().join(' ... ');
      return cb(null, text);
    });
  };

  exports.jq = function(inp, args, ctx, cb) {
    return jsdom.env(inp, function(err, window) {
      var $, els;
      $ = jquery(window);
      els = [];
      $(args.join(' ')).each(function() {
        var $el, attr, el_json, _i, _len, _ref;
        $el = $(this);
        el_json = {
          text: $el.text()
        };
        _ref = this.attributes;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          attr = _ref[_i];
          el_json[attr.name] = attr.value;
        }
        return els.push(el_json);
      });
      return cb(null, els);
    });
  };

}).call(this);
